<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body>
    <div class="container">
    <table class="table table-striped">
        <tr>
            <th>
                Task
            </td>
            <th>
                SQL
            </th>
        </tr>


        <tr>
            <td>
                Show each customer’s first name, last name, and their state’s population
            </td>
            <td>
                SELECT `users`. `fname` , `users` . `lname` `states` . `population` , `users.state` FROM users LEFT JOIN states ON(users.state = states.state);
            </td>
        </tr>

        <tr>
            <td>
                Show the following information for all sales: customer first name, last name, item
                purchased, and date purchased
            </td>
            <td>
               SELECT `users` . `fname`, `users` . `lname` , `sales`. `item` , `sales`.`dt` FROM `sales` LEFT JOIN `users` ON (users.cust_id = `sales` . `cust_id`)
            </td>
        </tr>

        <tr>
            <td>
                Show the total dollar amount purchased by each customer
            </td>
            <td>
                SELECT `users` . `fname`, `users` . `lname` , SUM(`sales`. `price`) FROM `users` LEFT JOIN `sales ` ON (`users`.`id` = `sales. `cust_id`) GROUP BY `sales` . `cust_id`
            </td>
        </tr>

        <tr>
            <td>
                Show the most expensive dollar amount purchased by each customer
            </td>
            <td>
                SELECT `users`.`fname`, `users`.`lname`, ROUND(MAX(`sales`.`price`), 2) AS `total` FROM `users` LEFT JOIN `sales` ON (`users`.`id` = `sales`.`cust_id`) GROUP BY `users`.`id` ORDER BY `total` DESC;
            </td>
        </tr>

        <tr>
            <td>
                Show the customers who made the most purchases
            </td>
            <td>
                SELECT `users`.`fname`, `users`.`lname`, COUNT(`sales`.`id`) AS `total` FROM `users` LEFT JOIN `sales` ON (`users`.`id` = `sales`.`cust_id`) GROUP BY `users`.`id` ORDER BY `total` DESC; 
            </td>
        </tr>

        <tr>
            <td>
                Show the customers who spent the most money
            </td>
            <td>
                SELECT `users`.`fname`, `users`.`lname`, ROUND(MAX(`sales`.`price`), 2) AS `total` FROM `users` LEFT JOIN `sales` ON (`users`.`id` = `sales`.`cust_id`) GROUP BY `users`.`id` ORDER BY `total` DESC;
            </td>
        </tr>

        <tr>
            <td>
                Show the states in order of which had the most number of sales.
            </td>
            <td>
                SELECT `states`.`statename`, COUNT(`sales`.`id`) AS `c`
                FROM `states`
                LEFT JOIN `users` ON `users`.`state` = `states`.`state`
                LEFT JOIN `sales` ON `users`.`id` = `sales`.`cust_id`
                GROUP BY `states`.`state`
                ORDER BY `c` DESC
            </td>
        </tr>

        <tr>
            <td>
                Show the states in order of which had the most dollar amount in sales. (Display the
                states’ full names, not abbreviations.)
            </td>
            <td>
                SELECT `states`.`statename`,SUM(`sales`.`price`) AS `c`
                FROM `states`
                LEFT JOIN `users` ON `users`.`state` = `states`.`state`
                LEFT JOIN `sales` ON `users`.`id` = `sales`.`cust_id`
                GROUP BY `states`.`state`
                ORDER BY `c` DESC
            </td>
        </tr>





















    </table>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>